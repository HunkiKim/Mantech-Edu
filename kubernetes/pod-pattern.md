# 사이드카 패턴

- 하나의 파드에 함께 배치하여 실행하면, 컨테이너간 통신이 더욱 편하다.
    - 로깅을 위한 컨테이너가 같은 파드 안에서 실행되면, 같은 볼륨을 공유 할 수 있어 로그 수집이 쉬워진다..
    - 이렇게 수집한 로그를 사이드카 컨테이너를 통해 중앙 집중적 수집을 할 수 있게 해준다.
- 이외에도 인증 컨테이너, 모니터링 컨테이너 등 다양한 컨테이너들이 Application 컨테이너를 보조 해줄 수 있다.
- 즉 보조 컨테이너를 통해 Application 컨테이너와 역할을 분리하기 위해 사용한다.

# 앰버서더 패턴

- Docker에서 처럼 Application Container를 외부 시스템과의 결합도를 낮추기 위해 사용합니다
- 앰버서더 컨테이너를 통해 내부에 컨테이너들을 포워딩 하는 방식으로 외부 시스템과 내부 시스템의 결합도를 낮출 수 있다.
    - 이를 통해 보안도 좋아질 수 있다. 애플리케이션 컨테이너가 직접 노출이 되지 않기 때문이다.
- 통신을 모니터링하고, 문제가 발생할 때 쉽게 대응하기 위해서이다.
- 통신 확장을편하게 하기 위해서이다.
    - 애플리케이션이 변경되어도, 앰버서더 컨테이너만 수정하면, 외부간의 통신은 그대로 사용할 수 있게 된다.
    - 즉 개방 폐쇄 원칙과 동일하다.
- 한마디로 통신을 중개해서 결합도를 낮추고, 보안을 강화하며, 통신 상태를 모니터링하고, 확장에 용이하도록 합니다.

# 어댑터 패턴

- 예를들면 Kubernetes API Server도 어댑터 패턴의 한 종류이다.
- 예를들면 같은 기능을 사용해도 추상화를 통해 호환되지 않는 인터페이스 간의 상호작용을 하게 합니다.
    - JPA도 어댑터 패턴을 사용해 DB Vendor와 상관없이 같은 기능을 사용 가능하게 해줍니다.
- Pod내에서도 데이터베이스 컨테이너와 웹서버 컨테이너 사이에 서로 다른 인터페이스가 다를 수 있다.
- 프로메테우스와 함께 동작하는 어댑터 패턴도 대표적 에시이다.
    - Application Container에서 지표(metric)을 어댑터 컨테이너에게 전송하고, 어댑터 컨테이너는  이를 외부 모니터링 시스템에서 사용할 수 있는 형태로 변경. 외부 모니터링 서비스에서 이 지표를 확인합니다.
- 한마디로 데이터 전처리 컨테이너다.
    - 데이터를 가공해서 원하는 서비스에 맞춰 제공해주는 컨테이너


# multi-container에 대해
## 사용하는 경우
- Pod 내에서 실행되면 효율적으로 자원 공유가 가능해집니다. 로그 수집 같은 경우는 Pod내 같은 볼륨을 공유할 수 있어 효율적입니다. 또 웹 서버 컨테이너는 해당 로그를 읽을 수 있습니다. 
- 서로 다른 역할을 하는 컨테이너들이 함께 실행되면, 애플리케이션 컨테이너와 결합도를 낮출 수 있습니다.
  - 예를들어, 인증 컨테이너를 따로 두게되면 Application의 인증기능이 분리되어 결합도를 낮추게 됩니다.
- 애플리케이션에 영향을 주지않는 사이드카 컨테이너를 이용해 로그 수집, 모니터링, 보안 등 추가 기능을 제공 가능합니다.
- Pod Cycle이 같은 경우 사용을 고려합니다.


## 사용하지 않는 경우
- 단순 애플리케이션의 경우, 필요가 없습니다. 단일 컨테이너가 더 간단하며 효율적입니다
- 애플리케이션이 특정 역할만 수행하는 경우, 단일 컨테이너가 더 적합할 수 있습니다.

## 장단점
### 장점
- 멀티 컨테이너가 높은 결합도를 보이는 경우, 복잡도를 낮추고 network 비용을 줄일 수 있음
- 어플리케이션 영향을 최소화할 경우, 코드 변경없이 배포 가능

### 단점
- 복잡성 증가
- 자원 사용
  - 다중 컨테이너는 자원 사용량이 증가할 가능성이 존재
- 배포 관리
  - 여러 컨테이너를 함께 업데이트 하거나, 배포하는 경우 복잡할 수 있음


## 언제 써야할까
- 결국 작은 규모라면 단일 컨테이너를 사용하는게 적합하지만, 복잡한 어플리케이션의 경우 역할을 분리한 컨테이너가 있는게 더 좋을 확률이 높다.
    